    'Iterate through all worksheets in the workbook    For Each ws In Worksheets            'Declare loop-driving variables        Dim rowcount As Integer        Dim row As Integer                'Declare variables for running values during loop        Dim maxPctTicker As String        Dim maxPct As Double        Dim minPctTicker As String        Dim minPct As Double        Dim maxVolTicker As String        Dim maxVol As Double                'Intialize variables for running values        maxPct = 0        minPct = 0        maxVol = 0                'Determine row count and start loop        rowcount = ws.Cells(ws.rows.Count, 9).End(xlUp).row        For row = 2 To rowcount                    'Declare variables that are iteration-specific in the loop            Dim ticker As String            Dim percent As Double            Dim volume As Double                                        'Grab values for the current row            ticker = ws.Cells(row, 9).Value            percent = CDbl(ws.Cells(row, 11).Value)            volume = CDbl(ws.Cells(row, 12).Value)                        'Ignore percent if it was marked as #NA because the opening price was 0            If percent <> CDbl(CVErr(xlErrNA)) Then 'Formula to produce the '#NA' error in the cell                            'Check if current percent is larger than the running maximum                If percent > maxPct Then                                        'Update the running maximum and its ticker symbol if larger                    maxPct = percent                    maxPctTicker = ticker                                    End If                                    'Check if current percent is smaller than the running minimum                If percent < minPct Then                                    'Update the running minimum and its ticker symbol if smaller                    minPct = percent                    minPctTicker = ticker                                    End If                            End If                            'Check if the current volume is larger than its running maximum            '(This needs to happen regardless of whether the current percent is valid or not)            If volume > maxVol Then                            'Update the running maximum and its ticker symbol if larger                maxVol = volume                maxVolTicker = ticker                            End If                Next row                'Once all rows have been iterated, record the results        'Using Range instead of Cells because all references here are hard-coded                'Set the row labels        ws.Range("O2") = "Greatest % Increase"        ws.Range("O3") = "Greatest % Decrease"        ws.Range("O4") = "Greatest Total Volume"                'Set the column labels        ws.Range("P1") = "Ticker"        ws.Range("Q1") = "Value"                'Set the greatest percent increase        ws.Range("P2") = maxPctTicker        ws.Range("Q2") = CDbl(maxPct)        ws.Range("Q2").NumberFormat = "0.00%"                'Set the greatest percent decrease        ws.Range("P3") = minPctTicker        ws.Range("Q3") = CDbl(minPct)        ws.Range("Q3").NumberFormat = "0.00%"                'Set the greatest volume        ws.Range("P4") = maxVolTicker        ws.Range("Q4") = CDbl(maxVol)        ws.Range("Q4").NumberFormat = "0.0000E+00"            'Loop to the next worksheet    Next ws